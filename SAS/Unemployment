data unemployment;
input month$ rate;
cards;
1990-01 5.4
1990-02 5.3
1990-03 5.2
1990-04 5.4
1990-05 5.4
1990-06 5.2
1990-07 5.5
1990-08 5.7
1990-09 5.9
1990-10 5.9
1990-11 6.2
1990-12 6.3
1991-01 6.4
1991-02 6.6
1991-03 6.8
1991-04 6.7
1991-05 6.9
1991-06 6.9
1991-07 6.8
1991-08 6.9
1991-09 6.9
1991-10 7.0
1991-11 7.0
1991-12 7.3
1992-01 7.3
1992-02 7.4
1992-03 7.4
1992-04 7.4
1992-05 7.6
1992-06 7.8
1992-07 7.7
1992-08 7.6
1992-09 7.6
1992-10 7.3
1992-11 7.4
1992-12 7.4
1993-01 7.3
1993-02 7.1
1993-03 7.0
1993-04 7.1
1993-05 7.1
1993-06 7.0
1993-07 6.9
1993-08 6.8
1993-09 6.7
1993-10 6.8
1993-11 6.6
1993-12 6.5
1994-01 6.6
1994-02 6.6
1994-03 6.5
1994-04 6.4
1994-05 6.1
1994-06 6.1
1994-07 6.1
1994-08 6.0
1994-09 5.9
1994-10 5.8
1994-11 5.6
1994-12 5.5
1995-01 5.6
1995-02 5.4
1995-03 5.4
1995-04 5.8
1995-05 5.6
1995-06 5.6
1995-07 5.7
1995-08 5.7
1995-09 5.6
1995-10 5.5
1995-11 5.6
1995-12 5.6
1996-01 5.6
1996-02 5.5
1996-03 5.5
1996-04 5.6
1996-05 5.6
1996-06 5.3
1996-07 5.5
1996-08 5.1
1996-09 5.2
1996-10 5.2
1996-11 5.4
1996-12 5.4
1997-01 5.3
1997-02 5.2
1997-03 5.2
1997-04 5.1
1997-05 4.9
1997-06 5.0
1997-07 4.9
1997-08 4.8
1997-09 4.9
1997-10 4.7
1997-11 4.6
1997-12 4.7
1998-01 4.6
1998-02 4.6
1998-03 4.7
1998-04 4.3
1998-05 4.4
1998-06 4.5
1998-07 4.5
1998-08 4.5
1998-09 4.6
1998-10 4.5
1998-11 4.4
1998-12 4.4
1999-01 4.3
1999-02 4.4
1999-03 4.2
1999-04 4.3
1999-05 4.2
1999-06 4.3
1999-07 4.3
1999-08 4.2
1999-09 4.2
1999-10 4.1
1999-11 4.1
1999-12 4.0
2000-01 4.0
2000-02 4.1
2000-03 4.0
2000-04 3.8
2000-05 4.0
2000-06 4.0
2000-07 4.0
2000-08 4.1
2000-09 3.9
2000-10 3.9
2000-11 3.9
2000-12 3.9
2001-01 4.2
2001-02 4.2
2001-03 4.3
2001-04 4.4
2001-05 4.3
2001-06 4.5
2001-07 4.6
2001-08 4.9
2001-09 5.0
2001-10 5.3
2001-11 5.5
2001-12 5.7
2002-01 5.7
2002-02 5.7
2002-03 5.7
2002-04 5.9
2002-05 5.8
2002-06 5.8
2002-07 5.8
2002-08 5.7
2002-09 5.7
2002-10 5.7
2002-11 5.9
2002-12 6.0
2003-01 5.8
2003-02 5.9
2003-03 5.9
2003-04 6.0
2003-05 6.1
2003-06 6.3
2003-07 6.2
2003-08 6.1
2003-09 6.1
2003-10 6.0
2003-11 5.8
2003-12 5.7
2004-01 5.7
2004-02 5.6
2004-03 5.8
2004-04 5.6
2004-05 5.6
2004-06 5.6
2004-07 5.5
2004-08 5.4
2004-09 5.4
2004-10 5.5
2004-11 5.4
2004-12 5.4
2005-01 5.3
2005-02 5.4
2005-03 5.2
2005-04 5.2
2005-05 5.1
2005-06 5.0
2005-07 5.0
2005-08 4.9
2005-09 5.0
2005-10 5.0
2005-11 5.0
2005-12 4.9
2006-01 4.7
2006-02 4.8
2006-03 4.7
2006-04 4.7
2006-05 4.6
2006-06 4.6
2006-07 4.7
2006-08 4.7
2006-09 4.5
2006-10 4.4
2006-11 4.5
2006-12 4.4
2007-01 4.6
2007-02 4.5
2007-03 4.4
2007-04 4.5
2007-05 4.4
2007-06 4.6
2007-07 4.7
2007-08 4.6
2007-09 4.7
2007-10 4.7
2007-11 4.7
2007-12 5.0
2008-01 5.0
2008-02 4.9
2008-03 5.1
2008-04 5.0
2008-05 5.4
2008-06 5.6
2008-07 5.8
2008-08 6.1
2008-09 6.1
2008-10 6.5
2008-11 6.8
2008-12 7.3
2009-01 7.8
2009-02 8.3
2009-03 8.7
2009-04 9.0
2009-05 9.4
2009-06 9.5
2009-07 9.5
2009-08 9.6
2009-09 9.8
2009-10 10.0
2009-11 9.9
2009-12 9.9
2010-01 9.8
2010-02 9.8
2010-03 9.9
2010-04 9.9
2010-05 9.6
2010-06 9.4
2010-07 9.4
2010-08 9.5
2010-09 9.5
2010-10 9.4
2010-11 9.8
2010-12 9.3
2011-01 9.1
2011-02 9.0
2011-03 9.0
2011-04 9.1
2011-05 9.0
2011-06 9.1
2011-07 9.0
2011-08 9.0
2011-09 9.0
2011-10 8.8
2011-11 8.6
2011-12 8.5
2012-01 8.3
2012-02 8.3
2012-03 8.2
2012-04 8.2
2012-05 8.2
2012-06 8.2
2012-07 8.2
2012-08 8.1
2012-09 7.8
2012-10 7.8
2012-11 7.7
2012-12 7.9
2013-01 8.0
2013-02 7.7
2013-03 7.5
2013-04 7.6
2013-05 7.5
2013-06 7.5
2013-07 7.3
2013-08 7.3
2013-09 7.3
2013-10 7.2
2013-11 6.9
2013-12 6.7
2014-01 6.6
2014-02 6.7
2014-03 6.7
2014-04 6.2
2014-05 6.2
2014-06 6.1
2014-07 6.2
2014-08 6.2
2014-09 6.0
2014-10 5.7
2014-11 5.8
2014-12 5.6
2015-01 5.7
2015-02 5.5
2015-03 5.5
2015-04 5.4
2015-05 5.5
2015-06 5.3
2015-07 5.3
2015-08 5.1
2015-09 5.1
2015-10 5.0
2015-11 5.0
2015-12 5.0
2016-01 4.9
2016-02 4.9
2016-03 5.0
2016-04 5.0
2016-05 4.7
2016-06 4.9
2016-07 4.9
2016-08 4.9
2016-09 5.0
2016-10 4.9
;
run;

*Setting up x-axis for our plot;
data sganno;
   retain function 'text' x1space 'datavalue' y1space 'datapercent' 
          rotate 90 anchor "right" width 30;
   set unemployment;
   label=month;
   xc1=month;
   y1=-5;
   m2 = substr(month,6,2);
   if m2 in (1,2,3,4,5,6,7,8,9,10,11) then label='';
run;

*Plotting unemployment rates over time, which are not stationary;
proc sgplot data=unemployment sganno=sganno pad=(bottom=15%); 
series x=month y=rate / markers;
xaxis display=(nolabel novalues);
run;

*SAC of original series, dies down extremely slowly;
proc arima data=unemployment plots(only)=series(ACF); 
identify var=rate;
run;

*Creating first differences model;
data unemployment2; 
set unemployment;
z = dif1(rate); *creates variable of first differences;
run;

*Plotting first differences model, still not stationary;
proc sgplot data=unemployment2 sganno=sganno pad=(bottom=15%); 
series x=month y=z / markers;
xaxis display=(nolabel novalues);
run;

*Creating second differences model;
data unemployment3; 
set unemployment2;
z2 = dif1(z); *creates variable of second differences;
run;

*Plotting second differences model, appears stationary;
proc sgplot data=unemployment3 sganno=sganno pad=(bottom=15%); 
series x=month y=z2 / markers;
xaxis display=(nolabel novalues);
run;

*SAC and SPAC of second differences model;
proc arima data=unemployment plots(only)=series(ACF PACF); 
identify var=rate(1,1);
run;

*Use the Moving Averages Model (MA(1));
proc arima data=unemployment plots=none; 
identify var=rate(1, 1); *using second differences;
estimate q=(1); *MA, q=1;
run;

*Delta is NOT significant;

*Estimates for Moving Averages model checked;
proc arima data=unemployment plots=none; 
identify var=rate(1, 1);
estimate q=(1) noconstant; *noconstant = no delta;
run;

*Checking diagnostics of Moving Averages model, found to be inadequate;
proc arima data=unemployment plots(only)=series(ACF PACF); 
identify var=rate(1,1);
estimate q=(1) noconstant;
run;

*Estimates for Moving Averages model with lags (1,2);
proc arima data=unemployment plots=none; 
identify var=rate(1, 1);
estimate q=(1, 2) noconstant;
run;

*Checking diagnostics for Moving Averages model with lags (1,2),
found to be adequate;
proc arima data=unemployment plots(only)=series(ACF PACF); 
identify var=rate(1,1);
estimate q=(1,2) noconstant;
run;

*Checking predictions of points through model;
proc arima data=unemployment plots=none; 
identify var=rate(1,1) noprint; 
estimate q=(1,2);
forecast lead=12 out=ratepredict;
run;
quit;

*Checking assumptions of random error term;
proc arima data=unemployment plots(only) = residual(qq smooth); 
identify var=rate(1, 1);
estimate q=(1, 2) noconstant;
run;